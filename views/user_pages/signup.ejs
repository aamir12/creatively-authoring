<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />
    <title> Examineer | Author Dash Board</title>
    <!-- Bootstrap core CSS     -->
     <link href="../../author_public/PaperDashBoard/css/bootstrap.min.css" rel="stylesheet" />
     <!--  Paper Dashboard core CSS    -->
     <link href="../../author_public/PaperDashBoard/css/paper-dashboard.css" rel="stylesheet"/>
    <!--  Fonts and icons     -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
     <link href='https://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'> 
    <!-- <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'> -->
    <link href="../../author_public/PaperDashBoard/css/themify-icons.css" rel="stylesheet">
    <!-- <link rel = "stylesheet" href="css/author1.css"> -->
    <link rel = "stylesheet" href="../../author_public/css/author.css">

    <!-- <link rel="stylesheet" href="css/bootstrap-tagsinput.css" /> --> 

    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="../../author_public/PaperDashBoard/css/demo.css" rel="stylesheet" />

    <link rel="stylesheet" href="../../author_public/plugins/daterangepicker/daterangepicker-bs3.css">
    <link rel="stylesheet" href="../../author_public/dist/css/skins/_all-skins.min.css">
    <link rel="stylesheet" href="../../author_public/plugins/colorpicker/bootstrap-colorpicker.min.css">
    <script src="../../author_public/PaperDashBoard/js/jquery-3.1.1.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.12/clipboard.min.js"></script>
    <link rel='stylesheet prefetch' href='https://s3-us-west-2.amazonaws.com/s.cdpn.io/438937/strength.css'>
    <link href="../../author_public/dist/css/pwstrength.css" rel="stylesheet" type="text/css">
    <style type="text/css">
      .navbar-inverse{
        background:#484541 !important;
      }
      .navbar{
        min-height: 74px !important;
      }
      ul.nav li:hover{
        background: #f4f3ef;
      }
      ul.nav li:hover a,a:hover{
        color:#66615b !important;
      }
      .footer{
        width:100%;
        border-top:solid 1px #e7e7e7;
        position:fixed;
        bottom:0;
        /* background: #333; */
        padding: 5px;
      }

      @media(max-width:991px){
        .footer  {
            position: unset !important;
         }
      }

      .footer > div > a{
        color:#484541;
      }
      .form-group, .input-group{
        border-bottom: solid 1px #e7e7e7;
      }
      #errModal .modal-content{
        background: #C70039;
          color: #FFF;
          text-align: justify;
      }
      #errModal .modal-body{
        font-size:16px;
          padding: 0 40px;
      }
      #errModal .modal-footer, .modal-header{
        border:none;
      }
      body{
        background-color: #f4f3ef;
      } 
      input{
        /* border-radius: 12px !important; */
        background: transparent !important;
        border:none !important;
      }
      #login{
          background-size:contain; 
          margin-top:6.5%;
          margin-bottom:50px !important;
      }
      #bg-img img{
          width:500px;height:400px;
      }
      .login-title, .error-msg
      {
        margin-bottom: 15%; 
        color:#fff;
        border-radius: 12px;
        padding: 12px 0 12px 0;
      }

      .login-title
      {
        margin-top: 10%;
        margin-bottom: 7%; 
        font-size: 28px;
        color: #66615b;
        padding: 8px 0 8px 0;
      }

      .active, .active a{
        background: #f4f3ef !important;
        color:#66615b !important;
      }

      @media (max-width: 992px) {
        ul.navbar-nav{
            display: none;
        }
        .login-title, #signInBtn{
            text-align: center !important;
        }
      }

      .error-msg{
        text-align: center;
        margin-top: -4%;
        margin-bottom: 2%; 
        font-size: 14px;
        background-color:#D24A49;
        display: none;

      }
      .btn-form{
        font-size: 18px;
        width:100%;
        background-color:#66615b;
        border: none;
        color: #fff;
        padding: 12px 0 12px 0;
        border-radius: 12px;
      }
      .btn-form:hover{
        color:#fff;
      }
      button:disabled {
          opacity: 1 !important;
      }
      .quizDateValidation{  
        display:none; 
        background-color:#D24A49;
        color:#fff;
        text-align: center;
        z-index: 9999;
      }
      @media screen and (max-width: 800px){
        .login-title
        {
          font-size: 30px;
        }
        .login-area{
        }
        #bg-img img{
          width:130px;height:100px;
        }
      }
    .custom-css
      {
        height: 46px;
        padding: 10px 16px;
        font-size: 18px;
        line-height: 1.3333333;
        border-radius: 12px;
        border: 1px solid #ccc;
      }
    </style>
    <script type="text/javascript">
    function navbarToggle(){
      $("ul.navbar-nav").toggle(300);
    }
  </script>
  </head>
  <body  onLoad='validate2()'>
    <div>
      <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" onclick="navbarToggle();">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar bar1"></span>
                    <span class="icon-bar bar2"></span>
                    <span class="icon-bar bar3"></span>
                </button>
                <a class="navbar-brand" href="#">Examineer</a>
            </div>
        
            <!-- Collect the nav links, forms, and other content for toggling -->
            <ul class="nav navbar-nav navbar-right">
                <li ><a  href="https://examineer.in">Student</a></li>
                <li class="active"><a>Author</a></li>
                <li><a href="#">Help</a></li>
            </ul>
        </div><!-- /.container-fluid -->
      </nav>
    </div>
    <div id="login" class="col-md-7 col-md-offset-5"> <!-- col-md-offset-3 -->
      <div class="row">
        <!-- <div id="bg-img" class="col-md-5">
          <center><img class="img img-responsive" src="../../author_public/images/forget.jpg" /></center>
        </div> -->
        <div id="login-area" class="col-md-5">
          <div class="login-title" align="center">
            <b>Register a new membership</b>
          </div>

          <input type="hidden" id="flagename" />
          <input type="hidden" id="flageemail" />
          <input type="hidden" id="flagepass2" />

          <% if (status=='success') { %>
            <div class="box-body" id="alert_box1">
              <div class="alert alert-success alert-dismissable">
                <i class="fa fa-ban"></i>
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">X</button>
                <b><%=msg%></b>
               </div>
            </div>
         <% } %>

         <% if (status=='error') { %>
            <div class="box-body" id="alert_box2">
              <div class="alert alert-danger alert-dismissable">
                <i class="fa fa-ban"></i>
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">X</button>
                <b><%=msg%></b>
               </div>
            </div>
         <% } %>

          <div  class="login-area">
            <form role="form" name="loginForm" action="/authoruserregister" method="post">
              <div class="form-group">
                <span id="result2"></span>
                <input type="email" id="email" name="email" class="form-control custom-css" placeholder="Email" value="<%-email%>" > <!-- onkeypress="validate2()" onkeyup="validate2()"-->
              </div>

              <div class="form-group">
                <span id="result1"></span>
                <input type="text" name="shortName" class="form-control custom-css" id="name" placeholder="Short name (eg: alex27)"/> <!-- onkeypress="validate_username()" maxlength="20" onkeyup="validate_username()" -->
              </div>
              <script type="text/javascript">
                $('#name, #email').focus(function(e) {
                    $(this).blur();
                });
              </script>

              <div class="form-group">
                <input type="password" name="password" id="password"  onkeypress="validate3()" onkeyup="validate3()"  class="form-control custom-css" data-indicator="pwindicator"  placeholder="Password"/>
                <div id="pwindicator">
                  <div class="bar"></div>
                  <div class="label" id="pass_strength"></div>
                </div>
              </div>
              <script type="text/javascript">
                $(document).ready(function() {
                  var text = "";
                  var email = document.getElementById("email").value;
                  console.log("email-----"+email);
                  text = email.slice(0, 5);
                  console.log("email slice-----"+text);
                  var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

                  for (var i = 0; i < 3; i++){
                    text += possible.charAt(Math.floor(Math.random() * possible.length));
                  }
                  document.getElementById("name").value = text;
                  validate_username();
                });
              </script>

              <div class="form-group" id="retypepassword">
                <span id="result4"></span>
                <input type="password" name="password2" id="password2" onkeyup="validate4()" class="form-control custom-css"  placeholder="Retype password"/>
              </div>

              <br>
              <div align="right" id="signInBtn">
                <button type="submit" class="btn btn-wd btn-lg btn-fill btn-move-right" id="submitbutton">
                  <b>Sign </b>up
                  <span class="btn-label">
                    <i class="ti-angle-right"></i>
                  </span>
                </button><br/><br/>
                <div class="forgot" style="font-size:16px;">
                    <!-- <a href="/authorlogin"><b>Sign In</b></a> -->
                    <a href="/authorlogin">I already have a membership</a>
                </div>
              </div>
            </form>
          </div>  
        </div>
      </div>
    </div>
   <script type="text/javascript">
  $(function(){
    var currentTime = new Date();
    var year = currentTime.getFullYear();
    $("#year").html(year);
  })
</script>
<div class="footer">
  <div class="pull-right">
    &copy; <span id="year"> </span>, All Rights Reserved. examineer.in, v1.0.01
  </div>
  </body>
  <%- include('../parts/allloginJS'); %>
  <script src="../../author_public/bootstrap/js/jquery.pwstrength.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript">
        jQuery(function($) { $('#password').pwstrength(); });
  </script>

       <!--function for check email format & email exit or not -->
       <script>
            //set the flagfor submit buttion
            function setflag(type,value)
            {
                if(type == 'flageusername')
                {
                  $("#flagename").val(value);
                }
                else if(type == 'flageemail')
                { 
                  $("#flageemail").val(value);
                }
                else if(type == 'flagepass2')
                {
                  $("#flagepass2").val(value);
                }

                var name      = $("#flagename").val();
                var email     = $("#flageemail").val();
                var pass2     = $("#flagepass2").val();

                if(name == 'ok' && email == 'ok' &&  pass2 == 'ok')
                {
                 $("#submitbutton").slideDown( "slow" );
                }
                else
                {
                 $( "#submitbutton" ).hide();
                }
            }
 
            //hide the retype password input type 
            $( "#retypepassword").hide();
            $( "#submitbutton").hide();
            $( "#email_not_allowed").hide();

            function validateEmail(email) {
                var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                return re.test(email);
            }

            //validation for email
            function validate2() {
              $("#result").text("");
              var email = $("#email").val();
              if (validateEmail(email)) {
                $('#alert2').remove();
                $( "#result2" ).append("<label class='control-label' id='alert2' for='inputSuccess' style='float:right; color:#f56954;'><i class='fa fa-ban'></i> unauthorized to register</label>");
                  //check the email register in our db or nor
                  $.post("/authorcheckallowemail",{"email":email}, function(data)
                     {
                        if(data == "email free")
                          {
                           $('#alert2').remove();
                           setflag('flageemail','ok');
                           $( "#result2" ).append("<label class='control-label' id='alert2' for='inputSuccess' style='float:right; color:#3d9970;'><i class='fa fa-check'></i> OK</label>");


                           $("#name").prop('disabled', false);
                           $("#password").prop('disabled', false);
                           $("#password2").prop('disabled', false);
                           $("#alert9").prop('disabled', false);
                           $("#pwindicator").prop('disabled', false);
                           $("#alert4").prop('disabled', false);

                          } 
                          else if(data == "email already exist")
                          {
                           $('#alert2').remove();
                           $( "#result2" ).append("<label class='control-label' id='alert2' for='inputSuccess' style='float:right; color:#f56954;'><i class='fa fa-ban'></i> Email Already Exists</label>");
                            setflag('flageemail','error');


                           $("#name").prop('disabled', true);
                           $("#password").prop('disabled', true);
                           $("#password2").prop('disabled', true);
                           $("#alert9").prop('disabled', true);
                           $("#pwindicator").prop('disabled', true);
                           $("#alert4").prop('disabled', true);

                          } 
                          else if(data == "email_not_allow")
                          {
                           $("#name").prop('disabled', true);
                           $("#password").prop('disabled', true);
                           $("#password2").prop('disabled', true);
                           $("#alert9").prop('disabled', true);
                           $("#pwindicator").prop('disabled', true);
                           $("#alert4").prop('disabled', true);

                            setflag('flageemail','error');
                          }
                    });
              } else {
                $('#alert2').remove();
                $( "#result2" ).append("<label class='control-label' id='alert2' for='inputSuccess' style='float:right; color:#f56954;'><i class='fa fa-ban'></i> Invaild Email</label>");
                 setflag('flageemail','error');
                 // $("#name").slideUp( "slow" );
                 $("#name").prop('disabled', true);
              }
              return false;
            }



             //validation for username
            function validate_username() {
              $("#result").text("");
                var name                = $("#name").val();
                var dname_without_space = name.replace(/ /g, "");
                var name                = dname_without_space.replace(/[^a-zA-Z 0-9]+/g, "");
                $("#name").val(name);
                $('#alert9').remove();
                
                  $.get("/authorcheckUsername/"+name , function(data)
                     {
                        if(data.msg == "username free")
                          {
                           $('#alert9').remove();
                           setflag('flageusername','ok');
                           $( "#result1" ).append("<label class='control-label' id='alert9' for='inputSuccess' style='float:right; color:#3d9970;'><i class='fa fa-check'></i> OK</label>");
                           // $("#name").slideDown( "slow" );
                          } 
                          else if(data.msg == "username used")
                          {
                           $('#alert9').remove();
                           $( "#result1" ).append("<label class='control-label' id='alert9' for='inputSuccess' style='float:right; color:#f56954;'><i class='fa fa-ban'></i>Short name already exists</label>");
                            setflag('flageusername','error');
                          } 
                           else if(data.msg == "username not allowed")
                          {
                           $('#alert9').remove();
                           $( "#result1" ).append("<label class='control-label' id='alert9' for='inputSuccess' style='float:right; color:#f56954;'><i class='fa fa-ban'></i>This short name already exists.</label>");
                            setflag('flageusername','error');
                          }
                     });

                     return false;
                    }

             //function for disable the enter button on form submited
             $('#register_form').on('keyup keypress', function(e) {
                var keyCode = e.keyCode || e.which;
                if (keyCode === 13) { 
                  e.preventDefault();
                  return false;
                }
               });


            //validation for user enter the user name
            function validate1() {
              $("#result").text("");
              var email = $("#name").val();
              if (email.length >= 1) {
                $('#alert1').remove();
                $( "#result1" ).append("<label class='control-label' id='alert1' for='inputSuccess' style='float:right; color:#3d9970;'><i class='fa fa-check'></i> OK</label>");
                setflag('flagename','ok');
              } else {
                $('#alert1').remove();
                $( "#result1" ).append("<label class='control-label' id='alert1' for='inputSuccess' style='float:right; color:#f56954;'><i class='fa fa-ban'></i> Invaild Name</label>");
                setflag('flagename','error');

              }
              return false;
            }
            

            //validation for password is right or nor
            function validate3() {
              setTimeout(function()
              {
                  $("#result").text("");
                  var email = $("#pass_strength").val();
                  var str = $( "#pass_strength").text();
                  if(str == "Ok" || str ==  "Strong" || str ==  "Very Strong")
                  {
                    $("#retypepassword").slideDown( "slow" );
                  }
                  else
                  {
                    $("#retypepassword").slideUp("slow");
                  }
              },300);
            }

            //check the password is match or nor
            function validate4() {
              var pass1 = $("#password").val();
              var pass2 = $("#password2").val();
              if(pass1 == pass2)
              {
                $('#alert4').remove();
                $( "#result4" ).append("<label class='control-label' id='alert4' for='inputSuccess' style='float:right; color:#3d9970;'><i class='fa fa-check'></i>Ok</label>");
                setflag('flagepass2','ok');
              }
              else
              {
                $('#alert4').remove();
                $( "#result4" ).append("<label class='control-label' id='alert4' for='inputSuccess' style='float:right; color:#f56954;'><i class='fa fa-ban'></i>Mismatch</label>");
                setflag('flagepass2','error');
              }
            }
       </script>
</html>